<html>
  <head>
    <title>Largest Number</title>
    <style>
      .highlight {
        color: red;
      }
    </style>
    <script>
      const compareValues = (n1, n2) => n1.value - n2.value;
      const promptAsync = (message, onData) =>
        setTimeout(() => onData(prompt(message)), 100);

      const getNumbersList = () => document.querySelector("#numbers");
      const getGroupsContainer = () => document.querySelector("#groups");

      const createNumberElement = (number) => {
        const numberElement = document.createElement("li");
        numberElement.innerText = number;
        numberElement.classList.add("number");

        return numberElement;
      };

      const createGroupElement = (title, numbers) => {
        const groupElement = document.createElement("div");

        const titleElement = document.createElement("h2");
        titleElement.innerText = title;
        const listElement = document.createElement("ul");
        numbers.forEach(({ element }) => listElement.appendChild(element));

        groupElement.appendChild(titleElement);
        groupElement.appendChild(listElement);

        return groupElement;
      };

      const displayNumber = (numberElement) => {
        const numbersContainer = getNumbersList();
        numbersContainer.appendChild(numberElement);
      };

      const readNumbers = (remaining, onNumber) => {
        if (remaining === 0) return;

        promptAsync("Enter Number", (number) => {
          onNumber(+number);
          readNumbers(remaining - 1, onNumber);
        });
      };

      const highlightLargestNumber = (numbers) => {
        const largestNumber = numbers.reduce((largest, current) =>
          largest.value < current.value ? current : largest
        );

        largestNumber.element.classList.add("highlight");
      };

      const removeChildren = (container) =>
        [...container.children].forEach((child) =>
          container.removeChild(child)
        );

      const displayNumbers = (numbers, container) => {
        numbers.forEach(({ element }) => container.appendChild(element));
      };

      const displayGroups = (groups) => {
        const groupsContainer = getGroupsContainer();
        removeChildren(groupsContainer);

        groups.forEach((group) => groupsContainer.appendChild(group));
      };

      const groupNumbers = (numbers, threshold) => {
        const groupElements = [];
        const numbersAbove = [];
        const numbersBelowOrEqual = [];

        numbers.forEach((number) => {
          if (number.value > threshold) numbersAbove.push(number);
          else numbersBelowOrEqual.push(number);
        });

        if (numbersAbove.length > 0) {
          groupElements.push(
            createGroupElement(
              `numbers above ${threshold}`,
              numbersAbove.sort(compareValues)
            )
          );
        }

        if (numbersBelowOrEqual.length > 0)
          groupElements.push(
            createGroupElement(
              `numbers below or equal to ${threshold}`,
              numbersBelowOrEqual.sort(compareValues)
            )
          );

        return groupElements;
      };

      const collectAndGroupNumbers = () => {
        const numbers = [];

        const addNumber = (value) => {
          const element = createNumberElement(value);
          numbers.push({ value, element });
        };

        promptAsync("Enter Threshold", (threshold) => {
          readNumbers(3, (number) => {
            addNumber(number);
            displayGroups(groupNumbers(numbers, threshold));
          });
        });
      };

      window.onload = collectAndGroupNumbers;
    </script>
  </head>
  <body>
    <div id="groups"></div>
  </body>
</html>
